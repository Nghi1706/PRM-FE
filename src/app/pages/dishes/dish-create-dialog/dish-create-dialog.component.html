<div class="dish-create-dialog">
  <h2 mat-dialog-title>Create New Dish</h2>

  <mat-dialog-content>
    <form [formGroup]="dishForm" class="dish-form">
      <!-- Image Upload Section -->
      <div class="image-section">
        <div class="image-preview">
          <img [src]="previewUrl || '/assets/images/default-dish.svg'" alt="Dish preview" class="dish-image" />
          <div class="image-overlay">
            <button type="button" mat-icon-button color="primary" (click)="fileInput.click()" [disabled]="loading">
              <mat-icon>camera_alt</mat-icon>
            </button>
            <button
              type="button"
              mat-icon-button
              color="warn"
              *ngIf="previewUrl"
              (click)="removeFile()"
              [disabled]="loading"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
        <input
          #fileInput
          type="file"
          accept="image/*"
          (change)="onFileSelected($event)"
          style="display: none"
        />
        <p class="image-hint">Click to upload dish image (Max 5MB)</p>
      </div>

      <!-- Name Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Dish Name</mat-label>
        <input matInput formControlName="name" placeholder="Enter dish name" [disabled]="loading" />
        <mat-icon matSuffix>restaurant_menu</mat-icon>
        <mat-error *ngIf="f['name'].hasError('required')">Dish name is required</mat-error>
        <mat-error *ngIf="f['name'].hasError('minlength')">Name must be at least 2 characters</mat-error>
        <mat-error *ngIf="f['name'].hasError('maxlength')">Name must not exceed 100 characters</mat-error>
      </mat-form-field>

      <!-- Description Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          formControlName="description"
          placeholder="Enter dish description (optional)"
          rows="3"
          [disabled]="loading"
        ></textarea>
        <mat-icon matSuffix>description</mat-icon>
        <mat-error *ngIf="f['description'].hasError('maxlength')">Description must not exceed 500 characters</mat-error>
      </mat-form-field>

      <!-- Price Field -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Price</mat-label>
        <input matInput type="number" formControlName="price" placeholder="Enter price" [disabled]="loading" min="0" />
        <span matPrefix>â‚«&nbsp;</span>
        <mat-icon matSuffix>attach_money</mat-icon>
        <mat-error *ngIf="f['price'].hasError('required')">Price is required</mat-error>
        <mat-error *ngIf="f['price'].hasError('min')">Price must be greater than or equal to 0</mat-error>
      </mat-form-field>

      <!-- Category Selection -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Category</mat-label>
        <mat-select formControlName="categoryId" [disabled]="loading">
          <mat-option *ngFor="let category of categories" [value]="category.m06Id">
            {{ category.m06Name }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix>category</mat-icon>
        <mat-error *ngIf="f['categoryId'].hasError('required')">Category is required</mat-error>
      </mat-form-field>

      <!-- Active Status Checkbox -->
      <div class="checkbox-field">
        <mat-checkbox formControlName="isActive" [disabled]="loading">Active Dish</mat-checkbox>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()" class="cancel-button" [disabled]="loading">Cancel</button>
    <button
      mat-raised-button
      color="primary"
      type="button"
      (click)="onCreate()"
      [disabled]="dishForm.invalid || loading"
      class="create-button"
    >
      <mat-spinner diameter="20" *ngIf="loading" style="margin-right: 8px"></mat-spinner>
      <mat-icon *ngIf="!loading">add</mat-icon>
      Create Dish
    </button>
  </mat-dialog-actions>
</div>
